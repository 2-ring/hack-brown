{
  "version": 3,
  "sources": ["../../compat/detect.ts", "../../compat/storage.ts", "../../compat/notifications.ts", "../../compat/panel.ts", "../../compat/polling.ts", "../../theme.ts", "../../popup/popup.ts"],
  "sourcesContent": ["// Feature detection for cross-browser compatibility.\n// All branching in the compat layer uses these flags \u2014 never browser sniffing.\n\ndeclare const browser: typeof chrome | undefined;\n\nconst _chrome = globalThis.chrome;\n\n/** Firefox exposes `browser.*` with native Promise support */\nexport const hasNativeBrowserAPI = typeof browser !== 'undefined';\n\n/** The base API object \u2014 Firefox `browser` or Chrome/Safari `chrome` */\nexport const api: typeof chrome = hasNativeBrowserAPI\n  ? (browser as typeof chrome)\n  : _chrome;\n\n/** chrome.sidePanel (Chrome 114+) */\nexport const hasSidePanel =\n  typeof _chrome !== 'undefined' && 'sidePanel' in _chrome;\n\n/** browser.sidebarAction (Firefox) */\nexport const hasSidebarAction =\n  typeof browser !== 'undefined' &&\n  typeof (browser as any).sidebarAction?.open === 'function';\n\n/** chrome.storage.session (Chrome 102+, Firefox 115+) */\nexport const hasSessionStorage =\n  typeof _chrome !== 'undefined' &&\n  typeof _chrome.storage !== 'undefined' &&\n  'session' in _chrome.storage;\n\n/** chrome.notifications (not available in Safari extensions) */\nexport const hasNotifications =\n  typeof _chrome !== 'undefined' && 'notifications' in _chrome;\n\n/** chrome.action.openPopup() (Chrome 127+, Firefox 127+) */\nexport const hasOpenPopup =\n  typeof _chrome !== 'undefined' &&\n  typeof _chrome.action?.openPopup === 'function';\n\n/** chrome.alarms (all MV3 browsers) */\nexport const hasAlarms =\n  typeof _chrome !== 'undefined' && 'alarms' in _chrome;\n", "// Unified storage API with a fallback for browsers without chrome.storage.session.\n// Safari (older versions) lacks session storage \u2014 we emulate it by namespacing\n// keys in local storage with a \"__session:\" prefix and clearing on startup.\n\nimport { api, hasSessionStorage } from './detect';\n\nconst SESSION_PREFIX = '__session:';\n\n// Minimal interface for the storage methods we actually use.\n// Avoids fighting with chrome.storage.StorageArea's complex overloads.\nexport interface SimpleStorageArea {\n  get(keys: string | string[] | null, callback: (items: Record<string, any>) => void): void;\n  set(items: Record<string, any>, callback?: () => void): void;\n  remove(keys: string | string[], callback?: () => void): void;\n  clear(callback?: () => void): void;\n  onChanged: {\n    addListener(callback: (changes: Record<string, chrome.storage.StorageChange>, areaName?: string) => void): void;\n  };\n}\n\nfunction prefixKeys(keys: string | string[] | Record<string, any>): string[] {\n  if (typeof keys === 'string') return [`${SESSION_PREFIX}${keys}`];\n  if (Array.isArray(keys)) return keys.map((k) => `${SESSION_PREFIX}${k}`);\n  return Object.keys(keys).map((k) => `${SESSION_PREFIX}${k}`);\n}\n\nfunction prefixRecord(items: Record<string, any>): Record<string, any> {\n  const out: Record<string, any> = {};\n  for (const [k, v] of Object.entries(items)) {\n    out[`${SESSION_PREFIX}${k}`] = v;\n  }\n  return out;\n}\n\nfunction unprefixRecord(result: Record<string, any>): Record<string, any> {\n  const out: Record<string, any> = {};\n  for (const [k, v] of Object.entries(result)) {\n    if (k.startsWith(SESSION_PREFIX)) {\n      out[k.slice(SESSION_PREFIX.length)] = v;\n    }\n  }\n  return out;\n}\n\n// ===== Session fallback change listeners =====\n\ntype StorageChangeCallback = (\n  changes: Record<string, chrome.storage.StorageChange>,\n  areaName?: string,\n) => void;\n\nconst sessionFallbackListeners = new Set<StorageChangeCallback>();\nlet localChangeListenerInstalled = false;\n\nfunction ensureLocalChangeListener(): void {\n  if (localChangeListenerInstalled) return;\n  localChangeListenerInstalled = true;\n\n  api.storage.local.onChanged.addListener((changes) => {\n    if (sessionFallbackListeners.size === 0) return;\n\n    const sessionChanges: Record<string, chrome.storage.StorageChange> = {};\n    let hasChanges = false;\n\n    for (const [key, change] of Object.entries(changes)) {\n      if (key.startsWith(SESSION_PREFIX)) {\n        sessionChanges[key.slice(SESSION_PREFIX.length)] = change;\n        hasChanges = true;\n      }\n    }\n\n    if (hasChanges) {\n      for (const listener of sessionFallbackListeners) {\n        listener(sessionChanges, 'session');\n      }\n    }\n  });\n}\n\n// ===== Fallback implementation =====\n\nconst sessionFallback: SimpleStorageArea = {\n  get(keys, callback) {\n    const prefixed = keys === null ? null : prefixKeys(keys);\n    api.storage.local.get(prefixed, (result) => {\n      callback(unprefixRecord(result));\n    });\n  },\n\n  set(items, callback) {\n    if (callback) {\n      api.storage.local.set(prefixRecord(items), callback);\n    } else {\n      api.storage.local.set(prefixRecord(items));\n    }\n  },\n\n  remove(keys, callback) {\n    const prefixed = prefixKeys(keys);\n    if (callback) {\n      api.storage.local.remove(prefixed, callback);\n    } else {\n      api.storage.local.remove(prefixed);\n    }\n  },\n\n  clear(callback) {\n    api.storage.local.get(null, (all) => {\n      const sessionKeys = Object.keys(all).filter((k) => k.startsWith(SESSION_PREFIX));\n      if (sessionKeys.length > 0) {\n        if (callback) {\n          api.storage.local.remove(sessionKeys, callback);\n        } else {\n          api.storage.local.remove(sessionKeys);\n        }\n      } else {\n        callback?.();\n      }\n    });\n  },\n\n  onChanged: {\n    addListener(callback: StorageChangeCallback) {\n      ensureLocalChangeListener();\n      sessionFallbackListeners.add(callback);\n    },\n  },\n};\n\n/** Clear ephemeral session keys on service worker startup (mimics session storage behavior). */\nexport function clearSessionFallback(): void {\n  if (!hasSessionStorage) {\n    sessionFallback.clear();\n  }\n}\n\n// ===== Exported storage object =====\n\n// Wrap the real chrome.storage.session to match our SimpleStorageArea interface.\n// This avoids type issues with chrome's complex overloaded signatures.\nfunction wrapNativeSession(): SimpleStorageArea {\n  const native = api.storage.session;\n  return {\n    get(keys, callback) { native.get(keys, callback); },\n    set(items, callback) { if (callback) native.set(items, callback); else native.set(items); },\n    remove(keys, callback) { if (callback) native.remove(keys, callback); else native.remove(keys); },\n    clear(callback) { if (callback) native.clear(callback); else native.clear(); },\n    onChanged: native.onChanged,\n  };\n}\n\nexport const storage = {\n  local: api.storage.local,\n  session: hasSessionStorage ? wrapNativeSession() : sessionFallback,\n  onChanged: api.storage.onChanged,\n};\n", "// Cross-browser notification abstraction.\n// Safari extensions lack chrome.notifications \u2014 gracefully no-ops there.\n\nimport { api, hasNotifications } from './detect';\n\nexport const notifications = {\n  create(\n    id: string,\n    options: { type: 'basic'; iconUrl: string; title: string; message: string },\n  ): void {\n    if (hasNotifications) {\n      api.notifications.create(id, options);\n    }\n  },\n\n  onClicked: hasNotifications\n    ? api.notifications.onClicked\n    : { addListener: (_cb: (id: string) => void) => {} },\n};\n", "// Unified side panel adapter.\n// Chrome \u2192 chrome.sidePanel.\n// Firefox \u2192 browser.sidebarAction.\n// Safari \u2192 browser.sidebarAction (Safari supports it in MV3).\n\nimport { api, hasSidePanel, hasSidebarAction } from './detect';\nimport { storage } from './storage';\n\ndeclare const browser: typeof chrome | undefined;\n\nexport interface PanelAdapter {\n  open(options: { windowId?: number; sessionId?: string }): Promise<void>;\n  isSupported: boolean;\n}\n\nfunction chromeSidePanel(): PanelAdapter {\n  return {\n    isSupported: true,\n    async open({ windowId, sessionId }) {\n      if (sessionId) {\n        await new Promise<void>((resolve) => {\n          storage.session.set({ sidebarSessionId: sessionId }, resolve);\n        });\n      }\n      if (windowId) {\n        await (api.sidePanel as any).open({ windowId });\n      }\n    },\n  };\n}\n\nfunction firefoxSidebar(): PanelAdapter {\n  return {\n    isSupported: true,\n    async open({ sessionId }) {\n      // sidebarAction.open() MUST be called before any await \u2014 Firefox loses\n      // the user-action context after an async gap (Bugzilla #1800401).\n      await (browser as any).sidebarAction.open();\n      if (sessionId) {\n        storage.session.set({ sidebarSessionId: sessionId });\n      }\n    },\n  };\n}\n\nexport const panel: PanelAdapter = hasSidePanel\n  ? chromeSidePanel()\n  : firefoxSidebar();\n", "// Alarm-based polling that survives service worker restarts.\n// Falls back to setInterval for contexts where alarms aren't available\n// (e.g., if permission is missing), but alarms are the primary mechanism.\n\nimport { api, hasAlarms } from './detect';\n\nconst ALARM_PREFIX = 'poll:';\nconst POLL_PERIOD_MINUTES = 1 / 30; // ~2 seconds (Chrome enforces 30s min in production)\n// Chrome enforces a minimum of 30s for alarm periods. For faster polling,\n// we use a single alarm as a keep-alive and do rapid polling via setTimeout\n// within the alarm handler. The alarm ensures the service worker stays alive.\n\nconst RAPID_POLL_MS = 2000;\nconst KEEPALIVE_ALARM = 'poll-keepalive';\n\ntype PollCallback = (sessionId: string) => Promise<void>;\n\nlet pollCallback: PollCallback | null = null;\nlet activePolls = new Set<string>();\nlet rapidTimers = new Map<string, ReturnType<typeof setTimeout>>();\n\n/** Register the callback that executes on each poll tick. Call once at startup. */\nexport function onPollTick(callback: PollCallback): void {\n  pollCallback = callback;\n\n  if (hasAlarms) {\n    api.alarms.onAlarm.addListener((alarm) => {\n      if (alarm.name === KEEPALIVE_ALARM) {\n        // Keepalive fired \u2014 the rapid setTimeout timers do the actual work.\n        // This just ensures the service worker stays alive.\n      }\n    });\n  }\n}\n\n/** Start polling a session. */\nexport function startPolling(sessionId: string): void {\n  activePolls.add(sessionId);\n  ensureKeepalive();\n  scheduleRapidPoll(sessionId);\n}\n\n/** Stop polling a session. */\nexport function stopPolling(sessionId: string): void {\n  activePolls.delete(sessionId);\n  const timer = rapidTimers.get(sessionId);\n  if (timer) {\n    clearTimeout(timer);\n    rapidTimers.delete(sessionId);\n  }\n  if (activePolls.size === 0) {\n    clearKeepalive();\n  }\n}\n\n/** Stop all active polls. */\nexport function stopAllPolling(): void {\n  for (const id of activePolls) {\n    const timer = rapidTimers.get(id);\n    if (timer) clearTimeout(timer);\n  }\n  activePolls.clear();\n  rapidTimers.clear();\n  clearKeepalive();\n}\n\n/** Check if a session is currently being polled. */\nexport function isPolling(sessionId: string): boolean {\n  return activePolls.has(sessionId);\n}\n\nfunction scheduleRapidPoll(sessionId: string): void {\n  if (!activePolls.has(sessionId)) return;\n\n  const tick = async () => {\n    if (!activePolls.has(sessionId) || !pollCallback) return;\n    try {\n      await pollCallback(sessionId);\n    } catch {\n      // Error handling is in the callback\n    }\n    // Schedule next tick if still active\n    if (activePolls.has(sessionId)) {\n      rapidTimers.set(sessionId, setTimeout(tick, RAPID_POLL_MS));\n    }\n  };\n\n  // First tick immediately\n  tick();\n}\n\nfunction ensureKeepalive(): void {\n  if (hasAlarms) {\n    // Create a periodic alarm to keep the service worker alive.\n    // Chrome minimum is 30s for periodInMinutes, so we use delayInMinutes of 0.5\n    // and re-create on each fire.\n    api.alarms.get(KEEPALIVE_ALARM, (alarm) => {\n      if (!alarm) {\n        api.alarms.create(KEEPALIVE_ALARM, { periodInMinutes: 0.5 });\n      }\n    });\n  }\n}\n\nfunction clearKeepalive(): void {\n  if (hasAlarms) {\n    api.alarms.clear(KEEPALIVE_ALARM);\n  }\n}\n", "// Theme management for the browser extension.\n// Mirrors the frontend's ThemeProvider behavior: reads the user's theme_mode\n// preference ('light' | 'dark' | 'auto') and applies matching CSS variables.\n\nimport { storage } from './compat';\n\nexport type ThemeMode = 'light' | 'dark' | 'auto';\nexport type ResolvedTheme = 'light' | 'dark';\n\nconst STORAGE_KEY = 'themeMode';\n\n// ===== System preference detection =====\n\nfunction getSystemTheme(): ResolvedTheme {\n  return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n}\n\n// ===== Apply theme to document =====\n\nfunction applyTheme(resolved: ResolvedTheme): void {\n  document.documentElement.setAttribute('data-theme', resolved);\n}\n\n// ===== Resolve mode \u2192 actual theme =====\n\nfunction resolve(mode: ThemeMode): ResolvedTheme {\n  return mode === 'auto' ? getSystemTheme() : mode;\n}\n\n// ===== Public API =====\n\n/**\n * Initialize theming for a popup or sidebar page.\n * - Reads the stored theme_mode from storage.local\n * - Applies the resolved theme immediately\n * - Listens for storage changes (background updates theme_mode on auth)\n * - Listens for system theme changes when mode is 'auto'\n */\nexport function initTheme(): void {\n  // 1. Apply immediately from storage\n  storage.local.get(STORAGE_KEY, (result) => {\n    const mode: ThemeMode = result[STORAGE_KEY] || 'auto';\n    applyTheme(resolve(mode));\n  });\n\n  // 2. Listen for theme_mode changes in storage (e.g. background fetched new prefs)\n  storage.local.onChanged.addListener((changes) => {\n    if (changes[STORAGE_KEY]) {\n      const mode: ThemeMode = changes[STORAGE_KEY].newValue || 'auto';\n      applyTheme(resolve(mode));\n    }\n  });\n\n  // 3. Listen for OS-level theme changes (matters when mode === 'auto')\n  const mq = window.matchMedia('(prefers-color-scheme: dark)');\n  mq.addEventListener('change', () => {\n    storage.local.get(STORAGE_KEY, (result) => {\n      const mode: ThemeMode = result[STORAGE_KEY] || 'auto';\n      if (mode === 'auto') {\n        applyTheme(getSystemTheme());\n      }\n    });\n  });\n}\n", "import type { SessionRecord } from '../types';\nimport { initTheme } from '../theme';\nimport { api, storage, panel, hasSidebarAction } from '../compat';\n\ndeclare const browser: typeof chrome | undefined;\n\nconst API_URL = 'https://api.dropcal.ai';\n\n// ===== View State Machine =====\n// 'processing' reuses the input view with the animated drop zone border.\n// Success/error feedback is shown inline in the drop zone (green/red border).\n\ntype View = 'auth' | 'input' | 'processing' | 'settings';\n\nlet currentView: View = 'auth';\nconst viewAuth = document.getElementById('view-auth')!;\nconst viewInput = document.getElementById('view-input')!;\nconst viewSettings = document.getElementById('view-settings')!;\nconst popupHeader = document.getElementById('popup-header')!;\nconst dropZone = document.getElementById('drop-zone')!;\nconst dropZoneContent = document.getElementById('drop-zone-content')!;\nconst dropZoneSuccess = document.getElementById('drop-zone-success')!;\nconst dropZoneError = document.getElementById('drop-zone-error')!;\nconst feedbackActions = document.getElementById('feedback-actions')!;\n\nconst allViews = [viewAuth, viewInput, viewSettings];\n\nfunction resetDropZone(): void {\n  dropZone.classList.remove('processing', 'success', 'error');\n  dropZoneContent.classList.remove('hidden');\n  dropZoneSuccess.classList.add('hidden');\n  dropZoneError.classList.add('hidden');\n  feedbackActions.classList.add('hidden');\n}\n\nfunction showView(view: View): void {\n  for (const v of allViews) v.classList.add('hidden');\n  popupHeader.classList.toggle('hidden', view === 'auth' || view === 'settings');\n\n  if (view === 'auth') {\n    viewAuth.classList.remove('hidden');\n  } else if (view === 'input') {\n    viewInput.classList.remove('hidden');\n    resetDropZone();\n  } else if (view === 'processing') {\n    viewInput.classList.remove('hidden');\n    resetDropZone();\n    dropZone.classList.add('processing');\n  } else if (view === 'settings') {\n    viewSettings.classList.remove('hidden');\n  }\n\n  currentView = view;\n}\n\n// ===== Header =====\n\nconst headerBrand = document.getElementById('header-brand')!;\n\nheaderBrand.addEventListener('click', (e) => {\n  e.preventDefault();\n  api.tabs.create({ url: 'https://dropcal.ai' });\n});\n\nconst btnSettings = document.getElementById('btn-settings')!;\n\nbtnSettings.addEventListener('click', () => {\n  previousView = currentView as Exclude<View, 'settings'>;\n  showView('settings');\n  settingsSubView = 'main';\n  showSettingsSubView('main');\n  loadSettingsData();\n});\n\n// ============================================================\n// View: Auth\n// ============================================================\n\nconst btnSignin = document.getElementById('btn-signin')!;\n\nbtnSignin.addEventListener('click', () => {\n  api.runtime.sendMessage({ type: 'SIGN_IN' });\n  window.close();\n});\n\n// ============================================================\n// View: Input\n// ============================================================\n\n// ----- DOM refs -----\n\nconst btnLink = document.getElementById('btn-link')!;\nconst btnImages = document.getElementById('btn-images')!;\nconst btnFiles = document.getElementById('btn-files')!;\nconst btnCenter = document.getElementById('btn-center')!;\nconst btnAudio = document.getElementById('btn-audio')!;\nconst btnText = document.getElementById('btn-text')!;\nconst btnEmail = document.getElementById('btn-email')!;\n\nconst allButtons = [btnLink, btnImages, btnFiles, btnCenter, btnAudio, btnText, btnEmail];\n\nconst resultsSection = document.getElementById('results-section')!;\nconst resultsList = document.getElementById('results-list')!;\n\n// ----- Button handlers -----\n\n// Stop button clicks from bubbling to drop zone\nfor (const btn of allButtons) {\n  btn.addEventListener('click', (e) => e.stopPropagation());\n}\n\nfunction openDropcalInput(mode: string): void {\n  api.tabs.create({ url: `https://dropcal.ai?input=${mode}` });\n  window.close();\n}\n\nbtnLink.addEventListener('click', () => openDropcalInput('link'));\nbtnImages.addEventListener('click', () => openDropcalInput('image'));\nbtnFiles.addEventListener('click', () => openDropcalInput('document'));\nbtnCenter.addEventListener('click', () => openDropcalInput('upload'));\nbtnAudio.addEventListener('click', () => openDropcalInput('audio'));\nbtnText.addEventListener('click', () => openDropcalInput('text'));\nbtnEmail.addEventListener('click', () => openDropcalInput('email'));\n\n// ----- Drag & drop -----\n\ndropZone.addEventListener('dragover', (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n  dropZone.classList.add('dragging');\n});\n\ndropZone.addEventListener('dragleave', (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n  dropZone.classList.remove('dragging');\n});\n\ndropZone.addEventListener('drop', (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n  dropZone.classList.remove('dragging');\n\n  const dt = e.dataTransfer;\n  if (!dt) return;\n\n  if (dt.files && dt.files.length > 0) {\n    handleFiles(dt.files);\n    return;\n  }\n\n  const text = dt.getData('text/plain');\n  if (text && text.trim()) submitText(text.trim());\n});\n\n// ----- Global paste -----\n\ndocument.addEventListener('paste', (e) => {\n  if (currentView !== 'input') return;\n  const cd = e.clipboardData;\n  if (!cd) return;\n\n  if (cd.files && cd.files.length > 0) {\n    handleFiles(cd.files);\n    return;\n  }\n\n  const text = cd.getData('text/plain');\n  if (text && text.trim()) submitText(text.trim());\n});\n\n// ----- History rendering -----\n\n// Phosphor icon font class for backend icon names (kebab-case \u2192 ph-{name})\n// Falls back to inputType-based Phosphor class\nconst INPUT_TYPE_ICON: Record<SessionRecord['inputType'], string> = {\n  text: 'ph-pencil-simple',\n  image: 'ph-images',\n  page: 'ph-globe',\n  file: 'ph-files',\n};\n\nfunction getIconClass(session: SessionRecord): string {\n  if (session.icon) return `ph-${session.icon}`;\n  return INPUT_TYPE_ICON[session.inputType] || INPUT_TYPE_ICON.text;\n}\n\n// Track titles we've already animated so we only animate once per session\nconst animatedTitles = new Set<string>();\n// Track previous titles to detect when a title first appears\nconst prevTitles = new Map<string, string | null>();\n\nfunction animateTitle(el: HTMLElement, text: string, speed = 25): void {\n  let i = 0;\n  el.textContent = '';\n  el.classList.add('typing-cursor');\n  const interval = setInterval(() => {\n    if (i < text.length) {\n      el.textContent = text.substring(0, ++i);\n    } else {\n      clearInterval(interval);\n      el.classList.remove('typing-cursor');\n    }\n  }, speed);\n}\n\nfunction getTimeGroup(createdAt: number): string {\n  const now = new Date();\n  const daysDiff = Math.floor(\n    (now.getTime() - createdAt) / (1000 * 60 * 60 * 24),\n  );\n\n  if (daysDiff === 0) return 'Today';\n  if (daysDiff === 1) return 'Yesterday';\n  if (daysDiff <= 7) return '7 Days';\n  if (daysDiff <= 30) return '30 Days';\n  return 'Older';\n}\n\nfunction filterSessions(sessions: SessionRecord[]): SessionRecord[] {\n  return sessions.filter((session) => {\n    if (session.status === 'error') return false;\n    if (session.status === 'polling') return true;\n    return session.eventCount > 0;\n  });\n}\n\nfunction renderSkeletons(count = 5): void {\n  resultsSection.classList.remove('hidden');\n  resultsList.innerHTML = '';\n  for (let i = 0; i < count; i++) {\n    const row = document.createElement('div');\n    row.className = 'skeleton-row';\n    row.innerHTML = '<div class=\"skeleton-icon\"></div><div class=\"skeleton-title\"></div>';\n    resultsList.appendChild(row);\n  }\n}\n\nfunction renderHistory(sessions: SessionRecord[]): void {\n  const visible = filterSessions(sessions);\n\n  if (visible.length === 0) {\n    resultsSection.classList.add('hidden');\n    return;\n  }\n\n  resultsSection.classList.remove('hidden');\n  resultsList.innerHTML = '';\n\n  // Group sessions by time period\n  const groups = new Map<string, SessionRecord[]>();\n  const groupOrder = ['Today', 'Yesterday', '7 Days', '30 Days', 'Older'];\n\n  for (const session of visible) {\n    const group = getTimeGroup(session.createdAt);\n    if (!groups.has(group)) groups.set(group, []);\n    groups.get(group)!.push(session);\n  }\n\n  for (const groupName of groupOrder) {\n    const groupSessions = groups.get(groupName);\n    if (!groupSessions || groupSessions.length === 0) continue;\n\n    const groupEl = document.createElement('div');\n    groupEl.className = 'session-group';\n\n    const label = document.createElement('div');\n    label.className = 'session-group-label';\n    label.textContent = groupName;\n    groupEl.appendChild(label);\n\n    for (const session of groupSessions) {\n      const row = document.createElement('div');\n      row.className = 'session-row';\n      row.addEventListener('click', () => openSidebar(session.sessionId));\n\n      // Icon: use Phosphor font class from backend icon or inputType fallback\n      const icon = document.createElement('i');\n      icon.className = `session-icon ph ${getIconClass(session)}`;\n\n      // Title with skeleton / typing animation\n      const title = document.createElement('div');\n      title.className = 'session-row-title';\n\n      if (session.status === 'polling' && !session.title) {\n        // Skeleton title for processing sessions without a title yet\n        title.innerHTML = '<div class=\"skeleton-title\"></div>';\n      } else if (session.title) {\n        const prev = prevTitles.get(session.sessionId);\n        const shouldAnimate = prev === null && !animatedTitles.has(session.sessionId);\n\n        if (shouldAnimate) {\n          animatedTitles.add(session.sessionId);\n          animateTitle(title, session.title);\n        } else {\n          title.textContent = session.title;\n        }\n      } else {\n        title.textContent = 'Untitled';\n      }\n\n      if (session.status === 'polling') title.classList.add('processing');\n\n      row.appendChild(icon);\n      row.appendChild(title);\n\n      // Right indicator\n      if (session.status === 'polling') {\n        const pulse = document.createElement('div');\n        pulse.className = 'processing-indicator';\n        row.appendChild(pulse);\n      } else if (session.eventCount > 0) {\n        const badge = document.createElement('div');\n        badge.className = `event-count-badge${session.addedToCalendar ? '' : ' unsynced'}`;\n        badge.textContent = String(session.eventCount);\n        row.appendChild(badge);\n      }\n\n      groupEl.appendChild(row);\n    }\n\n    resultsList.appendChild(groupEl);\n  }\n\n  // Update previous titles for next render\n  for (const session of sessions) {\n    prevTitles.set(session.sessionId, session.title);\n  }\n}\n\n// ============================================================\n// Inline Feedback (shown inside drop zone)\n// ============================================================\n\nconst feedbackIcon = document.getElementById('feedback-icon')!;\nconst feedbackTitle = document.getElementById('feedback-title')!;\nconst feedbackSubtitle = document.getElementById('feedback-subtitle')!;\nconst feedbackErrorIcon = document.getElementById('feedback-error-icon')!;\nconst feedbackErrorTitle = document.getElementById('feedback-error-title')!;\nconst feedbackErrorSubtitle = document.getElementById('feedback-error-subtitle')!;\nconst btnDismissSuccess = document.getElementById('btn-dismiss-success')!;\nconst btnDismissError = document.getElementById('btn-dismiss-error')!;\n\nlet feedbackSessionId: string | null = null;\n\n// Sessions dismissed in this popup lifetime (guards against async race with storage)\nconst locallyDismissed = new Set<string>();\n\n// Feedback auto-expires after 24 hours even if not dismissed\nconst FEEDBACK_EXPIRY_MS = 24 * 60 * 60 * 1000;\n\nfunction shouldShowFeedback(session: SessionRecord): boolean {\n  if (session.status !== 'processed' && session.status !== 'error') return false;\n  if (session.dismissedAt) return false;\n  if (locallyDismissed.has(session.sessionId)) return false;\n  if (Date.now() - session.createdAt > FEEDBACK_EXPIRY_MS) return false;\n  return true;\n}\n\n// Walk the notification queue newest-first and return the first valid session.\nfunction findPendingNotification(sessions: SessionRecord[], queue: string[]): SessionRecord | null {\n  for (let i = queue.length - 1; i >= 0; i--) {\n    const session = sessions.find((s) => s.sessionId === queue[i]);\n    if (session && shouldShowFeedback(session)) return session;\n  }\n  return null;\n}\n\nfunction showFeedbackSuccess(session: SessionRecord): void {\n  feedbackSessionId = session.sessionId;\n\n  // Set icon to session icon or fallback to checkmark\n  if (session.icon) {\n    feedbackIcon.className = `ph-duotone ph-${session.icon} feedback-icon feedback-icon-success`;\n  } else {\n    feedbackIcon.className = 'ph-duotone ph-check-fat feedback-icon feedback-icon-success';\n  }\n\n  const count = session.eventCount;\n  feedbackTitle.textContent = count === 1 ? '1 Event Scheduled' : `${count} Events Scheduled`;\n  feedbackSubtitle.textContent = session.title || '';\n  feedbackSubtitle.classList.toggle('hidden', !session.title);\n\n  // Swap drop zone to success state\n  dropZone.classList.remove('processing', 'error');\n  dropZone.classList.add('success');\n  dropZoneContent.classList.add('hidden');\n  dropZoneError.classList.add('hidden');\n  dropZoneSuccess.classList.remove('hidden');\n\n  // Show action buttons below drop zone\n  btnDismissSuccess.classList.remove('hidden');\n  btnDismissError.classList.add('hidden');\n  feedbackActions.classList.remove('hidden');\n\n  // Ensure input view is visible\n  viewInput.classList.remove('hidden');\n  popupHeader.classList.remove('hidden');\n  currentView = 'input';\n}\n\nfunction showErrorState(): void {\n  dropZone.classList.remove('processing', 'success');\n  dropZone.classList.add('error');\n  dropZoneContent.classList.add('hidden');\n  dropZoneSuccess.classList.add('hidden');\n  dropZoneError.classList.remove('hidden');\n\n  btnDismissSuccess.classList.add('hidden');\n  btnDismissError.classList.remove('hidden');\n  feedbackActions.classList.remove('hidden');\n\n  viewInput.classList.remove('hidden');\n  popupHeader.classList.remove('hidden');\n  currentView = 'input';\n}\n\nfunction showFeedbackError(message: string): void {\n  feedbackSessionId = null;\n  feedbackErrorIcon.className = 'ph-duotone ph-warning-circle feedback-icon feedback-icon-error';\n  feedbackErrorTitle.textContent = message;\n  feedbackErrorSubtitle.textContent = '';\n  feedbackErrorSubtitle.classList.add('hidden');\n  showErrorState();\n}\n\nfunction showSessionError(session: SessionRecord): void {\n  feedbackSessionId = session.sessionId;\n\n  if (session.status === 'processed' && session.eventCount === 0) {\n    feedbackErrorIcon.className = 'ph-duotone ph-calendar-blank feedback-icon feedback-icon-error';\n    feedbackErrorTitle.textContent = 'No Events Found';\n    feedbackErrorSubtitle.textContent = session.title || 'No calendar events were detected.';\n  } else {\n    feedbackErrorIcon.className = 'ph-duotone ph-warning-circle feedback-icon feedback-icon-error';\n    feedbackErrorTitle.textContent = 'Processing Failed';\n    feedbackErrorSubtitle.textContent = session.errorMessage || '';\n  }\n  feedbackErrorSubtitle.classList.toggle('hidden', !feedbackErrorSubtitle.textContent);\n  showErrorState();\n}\n\nfunction showPendingFeedback(session: SessionRecord): void {\n  if (session.status === 'error' || session.eventCount === 0) {\n    showSessionError(session);\n  } else {\n    showFeedbackSuccess(session);\n  }\n}\n\ndropZone.addEventListener('click', async () => {\n  if (dropZone.classList.contains('success') && feedbackSessionId) {\n    const sid = feedbackSessionId;\n    feedbackSessionId = null;\n    locallyDismissed.add(sid);\n    await openSidebar(sid);\n    await new Promise<void>((resolve) => {\n      api.runtime.sendMessage({ type: 'DISMISS_SESSION', sessionId: sid }, () => resolve());\n    });\n    window.close();\n  } else if (dropZone.classList.contains('error') && feedbackSessionId) {\n    locallyDismissed.add(feedbackSessionId);\n    api.runtime.sendMessage({ type: 'DISMISS_SESSION', sessionId: feedbackSessionId });\n    feedbackSessionId = null;\n    showView('input');\n    refresh();\n  }\n});\n\nbtnDismissSuccess.addEventListener('click', (e) => {\n  e.stopPropagation();\n  if (feedbackSessionId) {\n    locallyDismissed.add(feedbackSessionId);\n    api.runtime.sendMessage({ type: 'DISMISS_SESSION', sessionId: feedbackSessionId });\n  }\n  feedbackSessionId = null;\n  showView('input');\n  refresh();\n});\n\nbtnDismissError.addEventListener('click', () => {\n  if (feedbackSessionId) {\n    locallyDismissed.add(feedbackSessionId);\n    api.runtime.sendMessage({ type: 'DISMISS_SESSION', sessionId: feedbackSessionId });\n    feedbackSessionId = null;\n  }\n  showView('input');\n  refresh();\n});\n\n// ============================================================\n// View: Settings\n// ============================================================\n\n// ----- Settings state -----\n\ntype SettingsSubView = 'main' | 'integrations' | 'disconnect';\nlet settingsSubView: SettingsSubView = 'main';\nlet settingsDateFormat: 'MM/DD/YYYY' | 'DD/MM/YYYY' = 'MM/DD/YYYY';\nlet settingsThemeMode: 'auto' | 'light' | 'dark' = 'auto';\nlet settingsProviders: Array<{\n  provider: 'google' | 'microsoft' | 'apple';\n  email: string;\n  connected: boolean;\n  is_primary: boolean;\n}> = [];\nlet settingsPlan: 'free' | 'pro' = 'free';\nlet previousView: View = 'input';\n\n// ----- Settings DOM refs -----\n\nconst settingsBackBtn = document.getElementById('settings-back-btn')!;\nconst settingsUserEmailEl = document.getElementById('settings-user-email')!;\nconst settingsMain = document.getElementById('settings-main')!;\nconst settingsIntegrationsView = document.getElementById('settings-integrations-view')!;\nconst settingsProvidersList = document.getElementById('settings-providers-list')!;\nconst settingsUpgrade = document.getElementById('settings-upgrade')!;\nconst settingsDateFormatBtn = document.getElementById('settings-date-format')!;\nconst settingsDateIcon = document.getElementById('settings-date-icon')!;\nconst settingsDateValue = document.getElementById('settings-date-value')!;\nconst settingsThemeBtn = document.getElementById('settings-theme')!;\nconst settingsThemeIcon = document.getElementById('settings-theme-icon')!;\nconst settingsThemeLabel = document.getElementById('settings-theme-label')!;\nconst settingsIntegrationsBtn = document.getElementById('settings-integrations-btn')!;\nconst settingsLogout = document.getElementById('settings-logout')!;\nconst settingsDisconnectBtn = document.getElementById('settings-disconnect-btn')!;\nconst settingsDisconnectBack = document.getElementById('settings-disconnect-back')!;\n\n// ----- Settings functions -----\n\nfunction showSettingsSubView(sub: SettingsSubView): void {\n  settingsSubView = sub;\n\n  // Toggle main vs integrations menu\n  settingsMain.classList.toggle('hidden', sub !== 'main');\n  settingsIntegrationsView.classList.toggle('hidden', sub === 'main');\n\n  // Footer button visibility\n  settingsLogout.classList.toggle('hidden', sub !== 'main');\n  settingsDisconnectBtn.classList.toggle('hidden', sub !== 'integrations');\n  settingsDisconnectBack.classList.toggle('hidden', sub !== 'disconnect');\n}\n\nfunction loadSettingsData(): void {\n  api.runtime.sendMessage({ type: 'GET_USER_PROFILE' }, (response) => {\n    if (response?.ok && response.profile) {\n      const p = response.profile;\n      settingsUserEmailEl.textContent = p.email || '';\n      settingsPlan = p.plan === 'pro' ? 'pro' : 'free';\n      settingsDateFormat = p.preferences?.date_format === 'DD/MM/YYYY' ? 'DD/MM/YYYY' : 'MM/DD/YYYY';\n      settingsThemeMode = (['auto', 'light', 'dark'].includes(p.preferences?.theme_mode) ? p.preferences.theme_mode : 'auto') as 'auto' | 'light' | 'dark';\n\n      // Update upgrade button text based on plan\n      const upgradeSpan = settingsUpgrade.querySelector('span')!;\n      upgradeSpan.textContent = settingsPlan === 'pro' ? 'Manage subscription' : 'Upgrade plan';\n\n      updateDateFormatUI();\n      updateThemeUI();\n    }\n  });\n}\n\nfunction updateDateFormatUI(): void {\n  settingsDateValue.textContent = settingsDateFormat;\n  if (settingsDateFormat === 'DD/MM/YYYY') {\n    settingsDateIcon.className = 'ph ph-globe-simple settings-item-icon';\n  } else {\n    settingsDateIcon.className = 'ph ph-football-helmet settings-item-icon';\n  }\n}\n\nfunction updateThemeUI(): void {\n  if (settingsThemeMode === 'auto') {\n    settingsThemeIcon.className = 'ph ph-flashlight settings-item-icon';\n    settingsThemeLabel.textContent = 'Auto theme';\n  } else if (settingsThemeMode === 'dark') {\n    settingsThemeIcon.className = 'ph ph-moon-stars settings-item-icon';\n    settingsThemeLabel.textContent = 'Dark mode';\n  } else {\n    settingsThemeIcon.className = 'ph ph-sun-horizon settings-item-icon';\n    settingsThemeLabel.textContent = 'Light mode';\n  }\n}\n\nfunction loadCalendarProviders(): void {\n  api.runtime.sendMessage({ type: 'GET_CALENDAR_PROVIDERS' }, (response) => {\n    if (response?.ok && response.providers) {\n      settingsProviders = response.providers;\n      renderProviders();\n    }\n  });\n}\n\nfunction renderProviders(): void {\n  settingsProvidersList.innerHTML = '';\n\n  const providerDefs: Array<{\n    key: 'google' | 'microsoft' | 'apple';\n    name: string;\n    iconClass: string;\n  }> = [\n    { key: 'google', name: 'Google', iconClass: 'ph ph-google-logo' },\n    { key: 'microsoft', name: 'Outlook', iconClass: 'ph ph-microsoft-outlook-logo' },\n    { key: 'apple', name: 'Apple', iconClass: 'ph ph-apple-logo' },\n  ];\n\n  for (const def of providerDefs) {\n    const provider = settingsProviders.find(p => p.provider === def.key);\n    const isConnected = provider?.connected ?? false;\n    const isPrimary = provider?.is_primary ?? false;\n    const inDisconnect = settingsSubView === 'disconnect';\n\n    const row = document.createElement('button');\n    row.className = 'settings-item settings-integration-row';\n    if (isConnected && isPrimary && !inDisconnect) {\n      row.classList.add('settings-integration-active');\n    }\n\n    const icon = document.createElement('i');\n    icon.className = `${def.iconClass} settings-item-icon`;\n\n    const info = document.createElement('div');\n    info.className = 'settings-integration-info';\n\n    const nameSpan = document.createElement('span');\n    nameSpan.className = 'settings-integration-name';\n    nameSpan.textContent = def.name;\n\n    const detailSpan = document.createElement('span');\n    detailSpan.className = 'settings-integration-detail';\n\n    if (!isConnected) {\n      detailSpan.textContent = inDisconnect ? 'Not connected' : 'Connect';\n      if (inDisconnect) {\n        row.style.opacity = '0.4';\n        row.style.cursor = 'default';\n      }\n    } else if (inDisconnect) {\n      detailSpan.textContent = 'Disconnect';\n      detailSpan.style.color = 'var(--error)';\n    } else {\n      detailSpan.textContent = provider?.email || '';\n    }\n\n    info.appendChild(nameSpan);\n    info.appendChild(detailSpan);\n\n    row.appendChild(icon);\n    row.appendChild(info);\n\n    // Right-side indicator\n    if (isConnected) {\n      const action = document.createElement('div');\n      action.className = 'settings-integration-actions';\n\n      if (inDisconnect) {\n        const signOutIcon = document.createElement('i');\n        signOutIcon.className = 'ph ph-sign-out';\n        signOutIcon.style.color = 'var(--error)';\n        action.appendChild(signOutIcon);\n      } else {\n        const starIcon = document.createElement('i');\n        starIcon.className = isPrimary ? 'ph ph-star settings-star-active' : 'ph ph-star settings-star-inactive';\n        action.appendChild(starIcon);\n      }\n\n      row.appendChild(action);\n    }\n\n    // Click handlers\n    if (isConnected && inDisconnect) {\n      row.addEventListener('click', () => {\n        api.runtime.sendMessage({ type: 'DISCONNECT_PROVIDER', provider: def.key }, (resp) => {\n          if (resp?.ok) loadCalendarProviders();\n        });\n      });\n    } else if (isConnected) {\n      row.addEventListener('click', () => {\n        api.runtime.sendMessage({ type: 'SET_PRIMARY_PROVIDER', provider: def.key }, (resp) => {\n          if (resp?.ok) {\n            // Optimistic update\n            for (const p of settingsProviders) {\n              p.is_primary = p.provider === def.key;\n            }\n            renderProviders();\n          }\n        });\n      });\n    } else if (!inDisconnect) {\n      // Not connected \u2014 open dropcal.ai to connect\n      row.addEventListener('click', () => {\n        api.tabs.create({ url: 'https://dropcal.ai' });\n      });\n    }\n\n    settingsProvidersList.appendChild(row);\n  }\n}\n\n// ----- Settings event listeners -----\n\nsettingsBackBtn.addEventListener('click', () => {\n  if (settingsSubView === 'integrations' || settingsSubView === 'disconnect') {\n    showSettingsSubView('main');\n  } else {\n    showView(previousView);\n    if (previousView === 'input') refresh();\n  }\n});\n\nsettingsUpgrade.addEventListener('click', () => {\n  api.tabs.create({ url: 'https://dropcal.ai/plans' });\n});\n\nsettingsDateFormatBtn.addEventListener('click', () => {\n  settingsDateFormat = settingsDateFormat === 'MM/DD/YYYY' ? 'DD/MM/YYYY' : 'MM/DD/YYYY';\n  updateDateFormatUI();\n  api.runtime.sendMessage({\n    type: 'UPDATE_PREFERENCES',\n    preferences: { date_format: settingsDateFormat },\n  });\n});\n\n// Theme toggle: auto \u2192 light \u2192 dark \u2192 auto\nsettingsThemeBtn.addEventListener('click', () => {\n  const cycle: Array<'auto' | 'light' | 'dark'> = ['auto', 'light', 'dark'];\n  const idx = cycle.indexOf(settingsThemeMode);\n  settingsThemeMode = cycle[(idx + 1) % 3];\n  updateThemeUI();\n  api.runtime.sendMessage({\n    type: 'UPDATE_PREFERENCES',\n    preferences: { theme_mode: settingsThemeMode },\n  });\n});\n\nsettingsIntegrationsBtn.addEventListener('click', () => {\n  api.tabs.create({ url: 'https://dropcal.ai/?settings=integrations' });\n  window.close();\n});\n\nsettingsLogout.addEventListener('click', () => {\n  api.runtime.sendMessage({ type: 'SIGN_OUT' }, () => {\n    showView('auth');\n  });\n});\n\nsettingsDisconnectBtn.addEventListener('click', () => {\n  showSettingsSubView('disconnect');\n  renderProviders();\n});\n\nsettingsDisconnectBack.addEventListener('click', () => {\n  showSettingsSubView('integrations');\n  renderProviders();\n});\n\n// ============================================================\n// Shared Helpers\n// ============================================================\n\nfunction submitText(text: string): void {\n  showView('processing');\n  api.runtime.sendMessage({ type: 'SUBMIT_TEXT', text }, (response) => {\n    if (response && !response.ok) {\n      showFeedbackError(response.error || 'Failed to process text');\n    } else {\n      window.close();\n    }\n  });\n}\n\nasync function handleFiles(files: FileList): Promise<void> {\n  showView('processing');\n\n  const authResult = await new Promise<Record<string, any>>((resolve) => {\n    storage.local.get('auth', (items) => resolve(items));\n  });\n  const token = authResult.auth?.accessToken;\n  if (!token) {\n    showFeedbackError('Not authenticated. Please sign in.');\n    return;\n  }\n\n  for (const file of Array.from(files)) {\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      const response = await fetch(`${API_URL}/upload`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}` },\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const err = await response.json().catch(() => ({ error: 'Upload failed' }));\n        showFeedbackError(err.error || `Upload failed (${response.status})`);\n        return;\n      }\n\n      const { session } = await response.json();\n\n      // Tell background to track and poll this session (lightweight message, no file data)\n      api.runtime.sendMessage({\n        type: 'TRACK_SESSION',\n        sessionId: session.id,\n        inputType: file.type.startsWith('image/') ? 'image' : 'file',\n      });\n    } catch {\n      showFeedbackError('Failed to upload file');\n      return;\n    }\n  }\n\n  window.close();\n}\n\nasync function openSidebar(sessionId: string): Promise<void> {\n  // Firefox sidebarAction.open() requires a user-action context and loses it\n  // after any await (Bugzilla #1800401). Call it FIRST, synchronously.\n  if (hasSidebarAction) {\n    (browser as any).sidebarAction.open();\n    storage.session.set({ sidebarSessionId: sessionId });\n    return;\n  }\n  // Chrome sidePanel needs windowId \u2014 awaits are fine here.\n  await new Promise<void>((resolve) => {\n    storage.session.set({ sidebarSessionId: sessionId }, resolve);\n  });\n  const win = await api.windows.getCurrent();\n  if (win.id) {\n    await panel.open({ windowId: win.id, sessionId });\n  }\n}\n\n// ============================================================\n// Notification State (controls drop zone feedback, independent of session list)\n// ============================================================\n\nfunction syncNotifications(sessions: SessionRecord[], queue: string[]): void {\n  if (currentView === 'processing') {\n    const pending = findPendingNotification(sessions, queue);\n    if (pending) {\n      showPendingFeedback(pending);\n      return;\n    }\n    if (!sessions.some((s) => s.status === 'polling')) {\n      const newest = sessions[0];\n      if (newest && (newest.status === 'error' || (newest.status === 'processed' && newest.eventCount === 0))) {\n        showSessionError(newest);\n      } else {\n        showView('input');\n      }\n    }\n    return;\n  }\n\n  if (currentView === 'input') {\n    const pending = findPendingNotification(sessions, queue);\n    if (pending && feedbackSessionId !== pending.sessionId) {\n      showPendingFeedback(pending);\n    }\n  }\n}\n\n// ============================================================\n// Refresh \u2014 reads storage once, updates session list + notifications independently\n// ============================================================\n\nfunction refresh(): void {\n  storage.local.get(['sessionHistory', 'notificationQueue'], (result) => {\n    const sessions =\n      (result.sessionHistory as { sessions: SessionRecord[] } | undefined)?.sessions || [];\n    const queue: string[] = result.notificationQueue || [];\n    renderHistory(sessions);\n    syncNotifications(sessions, queue);\n  });\n}\n\n// ============================================================\n// Storage Listeners\n// ============================================================\n\nstorage.local.onChanged.addListener((changes) => {\n  if (changes.sessionHistory || changes.notificationQueue) {\n    refresh();\n  }\n  if (changes.auth) {\n    api.runtime.sendMessage({ type: 'GET_AUTH' }, (response) => {\n      if (response?.isAuthenticated) {\n        showView('input');\n        refresh();\n      } else {\n        showView('auth');\n      }\n    });\n  }\n});\n\nstorage.session.onChanged.addListener(() => {\n  refresh();\n});\n\n// ============================================================\n// Init\n// ============================================================\n\ninitTheme();\n\napi.runtime.sendMessage({ type: 'GET_AUTH' }, (response) => {\n  const isAuth = response?.isAuthenticated ?? false;\n  if (!isAuth) {\n    showView('auth');\n    return;\n  }\n\n  // Show skeleton while loading initial history\n  showView('input');\n  renderSkeletons();\n\n  storage.local.get(['sessionHistory', 'notificationQueue'], (result) => {\n    const sessions =\n      (result.sessionHistory as { sessions: SessionRecord[] } | undefined)?.sessions || [];\n    const queue: string[] = result.notificationQueue || [];\n\n    // Seed prevTitles so existing titles don't animate on first load\n    for (const s of sessions) {\n      prevTitles.set(s.sessionId, s.title);\n      if (s.title) animatedTitles.add(s.sessionId);\n    }\n\n    // Set initial view: polling \u2192 processing, pending notification \u2192 feedback, else \u2192 input\n    if (sessions.some((s) => s.status === 'polling')) {\n      showView('processing');\n    } else {\n      const pending = findPendingNotification(sessions, queue);\n      if (pending) {\n        for (const v of allViews) v.classList.add('hidden');\n        showPendingFeedback(pending);\n      } else {\n        showView('input');\n      }\n    }\n\n    // Render session list (independent of notification state above)\n    renderHistory(sessions);\n  });\n});\n"],
  "mappings": "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",
  "names": ["_chrome", "hasNativeBrowserAPI", "api", "hasSidePanel", "hasSidebarAction", "hasSessionStorage", "hasNotifications", "hasOpenPopup", "hasAlarms", "SESSION_PREFIX", "prefixKeys", "keys", "k", "prefixRecord", "items", "out", "v", "unprefixRecord", "result", "sessionFallbackListeners", "localChangeListenerInstalled", "ensureLocalChangeListener", "api", "changes", "sessionChanges", "hasChanges", "key", "change", "listener", "sessionFallback", "callback", "prefixed", "all", "sessionKeys", "wrapNativeSession", "native", "api", "keys", "callback", "items", "storage", "hasSessionStorage", "sessionFallback", "notifications", "id", "options", "hasNotifications", "api", "_cb", "chromeSidePanel", "windowId", "sessionId", "resolve", "storage", "api", "firefoxSidebar", "panel", "hasSidePanel", "POLL_PERIOD_MINUTES", "STORAGE_KEY", "getSystemTheme", "applyTheme", "resolved", "resolve", "mode", "initTheme", "storage", "result", "changes", "API_URL", "currentView", "viewAuth", "viewInput", "viewSettings", "popupHeader", "dropZone", "dropZoneContent", "dropZoneSuccess", "dropZoneError", "feedbackActions", "allViews", "resetDropZone", "showView", "view", "v", "headerBrand", "api", "btnSettings", "previousView", "settingsSubView", "showSettingsSubView", "loadSettingsData", "btnSignin", "btnLink", "btnImages", "btnFiles", "btnCenter", "btnAudio", "btnText", "btnEmail", "allButtons", "resultsSection", "resultsList", "btn", "e", "openDropcalInput", "mode", "dt", "handleFiles", "text", "submitText", "cd", "INPUT_TYPE_ICON", "getIconClass", "session", "animatedTitles", "prevTitles", "animateTitle", "el", "speed", "i", "interval", "getTimeGroup", "createdAt", "daysDiff", "filterSessions", "sessions", "renderSkeletons", "count", "row", "renderHistory", "visible", "groups", "groupOrder", "group", "groupName", "groupSessions", "groupEl", "label", "openSidebar", "icon", "title", "pulse", "badge", "feedbackIcon", "feedbackTitle", "feedbackSubtitle", "feedbackErrorIcon", "feedbackErrorTitle", "feedbackErrorSubtitle", "btnDismissSuccess", "btnDismissError", "feedbackSessionId", "locallyDismissed", "FEEDBACK_EXPIRY_MS", "shouldShowFeedback", "findPendingNotification", "queue", "s", "showFeedbackSuccess", "showErrorState", "showFeedbackError", "message", "showSessionError", "showPendingFeedback", "sid", "resolve", "refresh", "settingsDateFormat", "settingsThemeMode", "settingsProviders", "settingsPlan", "settingsBackBtn", "settingsUserEmailEl", "settingsMain", "settingsIntegrationsView", "settingsProvidersList", "settingsUpgrade", "settingsDateFormatBtn", "settingsDateIcon", "settingsDateValue", "settingsThemeBtn", "settingsThemeIcon", "settingsThemeLabel", "settingsIntegrationsBtn", "settingsLogout", "settingsDisconnectBtn", "settingsDisconnectBack", "sub", "response", "p", "upgradeSpan", "updateDateFormatUI", "updateThemeUI", "loadCalendarProviders", "renderProviders", "providerDefs", "def", "provider", "isConnected", "isPrimary", "inDisconnect", "info", "nameSpan", "detailSpan", "action", "signOutIcon", "starIcon", "resp", "cycle", "idx", "files", "token", "storage", "items", "file", "formData", "err", "sessionId", "hasSidebarAction", "win", "panel", "syncNotifications", "pending", "newest", "result", "changes", "initTheme"]
}
